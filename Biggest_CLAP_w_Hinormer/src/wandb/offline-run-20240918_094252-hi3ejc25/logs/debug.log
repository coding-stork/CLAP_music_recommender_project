2024-09-18 09:42:52,790 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Current SDK version is 0.18.1
2024-09-18 09:42:52,791 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Configure stats pid to 46025
2024-09-18 09:42:52,792 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Loading settings from /root/.config/wandb/settings
2024-09-18 09:42:52,793 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Loading settings from /content/drive/MyDrive/CLAP/src/wandb/settings
2024-09-18 09:42:52,794 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Loading settings from environment variables: {}
2024-09-18 09:42:52,794 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Applying setup settings: {'mode': None, '_disable_service': None}
2024-09-18 09:42:52,794 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Inferring run settings from compute environment: {'program_relpath': 'src/laion_clap/training/main.py', 'program_abspath': '/content/drive/MyDrive/CLAP/src/laion_clap/training/main.py', 'program': '/content/drive/MyDrive/CLAP/src/laion_clap/training/main.py'}
2024-09-18 09:42:52,794 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Applying login settings: {}
2024-09-18 09:42:52,794 INFO    MainThread:46025 [wandb_setup.py:_flush():77] Applying login settings: {'mode': 'offline'}
2024-09-18 09:42:52,795 INFO    MainThread:46025 [wandb_init.py:_log_setup():532] Logging user logs to /content/drive/MyDrive/CLAP/src/wandb/offline-run-20240918_094252-hi3ejc25/logs/debug.log
2024-09-18 09:42:52,796 INFO    MainThread:46025 [wandb_init.py:_log_setup():533] Logging internal logs to /content/drive/MyDrive/CLAP/src/wandb/offline-run-20240918_094252-hi3ejc25/logs/debug-internal.log
2024-09-18 09:42:52,796 INFO    MainThread:46025 [wandb_init.py:init():616] calling init triggers
2024-09-18 09:42:52,796 INFO    MainThread:46025 [wandb_init.py:init():623] wandb.init called with sweep_config: {}
config: {'train_data': ['/content/spotify_train/train/0.tar'], 'val_data': ['/content/spotify_train/valid/0.tar'], 'freeze_text': False, 'freeze_text_after': -1, 'train_ipc': None, 'val_ipc': None, 'train_num_samples': None, 'val_num_samples': None, 'dataset_type': 'webdataset', 'csv_separator': '\t', 'csv_img_key': 'filepath', 'csv_caption_key': 'title', 'imagenet_val': None, 'imagenet_v2': None, 'datasetnames': ['spotify_train', 'audiocaps'], 'full_train_dataset': [], 'exclude_eval_dataset': [], 'datasetinfos': ['train', 'unbalanced_train'], 'dataset_proportion': 1.0, 'remotedata': False, 'class_label_path': None, 'datasetpath': '/content', 'logs': './logs/', 'log_local': False, 'name': '2024_09_18-09_42_35-model_HTSAT-tiny-lr_0.0001-b_4-j_2-p_fp32', 'workers': 2, 'batch_size': 4, 'epochs': 45, 'lr': 0.0001, 'beta1': 0.9, 'beta2': 0.999, 'eps': 1e-08, 'momentum': None, 'wd': 0, 'split_opt': False, 'lr_pretrained': None, 'beta1_pretrained': None, 'beta2_pretrained': None, 'eps_pretrained': None, 'wd_pretrained': 0, 'momentum_pretrained': 0.9, 'lr_new': None, 'beta1_new': None, 'beta2_new': None, 'eps_new': None, 'wd_new': 0, 'momentum_new': 0.9, 'warmup': 3200, 'use_bn_sync': True, 'skip_scheduler': False, 'save_frequency': 5, 'save_top_performance': 3, 'save_most_recent': True, 'zeroshot_frequency': 2, 'val_frequency': 1, 'resume': None, 'precision': 'fp32', 'amodel': 'HTSAT-tiny', 'tmodel': 'roberta', 'pretrained_audio': '/content/audio_pretrained_model/HTSAT-fullset-imagenet-map=0.467.ckpt', 'pretrained_text': '', 'pretrained': '', 'pretrained_image': False, 'lock_image': False, 'lock_image_unlocked_groups': 0, 'lock_image_freeze_bn_stats': False, 'local_loss': False, 'gather_with_grad': True, 'force_quick_gelu': False, 'torchscript': False, 'trace': False, 'dist_url': 'env://', 'dist_backend': 'nccl', 'report_to': 'wandb', 'wandb_notes': '10.16-clap-dataset-1#-htsat-roberta', 'C': 3.16, 'debug': False, 'copy_codebase': False, 'horovod': False, 'ddp_static_graph': False, 'no_set_device_rank': False, 'seed': 3407, 'top_k_checkpoint_select_dataset': 'Clotho-test', 'top_k_checkpoint_select_metric': 'mAP@10', 'openai_model_cache_dir': '/content/transformers_cache', 'optimizer': 'adam', 'parallel_eval': False, 'no_eval': False, 'lp_mlp': False, 'lp_freeze': False, 'lp_act': 'None', 'lp_loss': 'bce', 'lp_metrics': 'map,mauc,acc', 'lp_lr': 0.0001, 'kappa': 0, 'data_filling': 'repeatpad', 'data_truncating': 'rand_trunc', 'clap_mlploss': False, 'wandb_id': None, 'sleep': 0, 'enable_fusion': False, 'fusion_type': 'None', 'mixup': False, 'text_augment_selection': None, 'prefetch_factor': None, 'distributed': False, 'local_rank': 0, 'rank': 0, 'world_size': 1, 'log_path': './logs/2024_09_18-09_42_35-model_HTSAT-tiny-lr_0.0001-b_4-j_2-p_fp32/out.log', 'log_level': 20, 'device': 'cpu', 'wandb': True, 'tensorboard': False, 'tensorboard_path': '', 'checkpoint_path': './logs/2024_09_18-09_42_35-model_HTSAT-tiny-lr_0.0001-b_4-j_2-p_fp32/checkpoints', 'class_index_dict': None, 'val_dataset_names': ['spotify_train', 'audiocaps'], 'save_logs': True, 'train_sz': 1000, 'val_sz': 1000}
2024-09-18 09:42:52,796 INFO    MainThread:46025 [wandb_init.py:init():666] starting backend
2024-09-18 09:42:52,797 INFO    MainThread:46025 [wandb_init.py:init():670] setting up manager
2024-09-18 09:42:52,811 INFO    MainThread:46025 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-09-18 09:42:52,814 INFO    MainThread:46025 [wandb_init.py:init():678] backend started and connected
2024-09-18 09:42:52,862 INFO    MainThread:46025 [wandb_init.py:init():773] updated telemetry
2024-09-18 09:42:52,995 INFO    MainThread:46025 [wandb_init.py:init():806] communicating run to backend with 90.0 second timeout
2024-09-18 09:42:53,269 INFO    MainThread:46025 [wandb_init.py:init():857] starting run threads in backend
2024-09-18 09:42:53,738 INFO    MainThread:46025 [wandb_run.py:_console_start():2459] atexit reg
2024-09-18 09:42:53,739 INFO    MainThread:46025 [wandb_run.py:_redirect():2307] redirect: wrap_raw
2024-09-18 09:42:53,741 INFO    MainThread:46025 [wandb_run.py:_redirect():2372] Wrapping output streams.
2024-09-18 09:42:53,742 INFO    MainThread:46025 [wandb_run.py:_redirect():2397] Redirects installed.
2024-09-18 09:42:53,749 INFO    MainThread:46025 [wandb_init.py:init():900] run started, returning control to user process
2024-09-18 09:42:53,779 WARNING MsgRouterThr:46025 [router.py:message_loop():77] message_loop has been closed
